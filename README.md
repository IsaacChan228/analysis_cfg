# Multi-Tool Control Flow Graph Comparison Framework

## Overview
This framework provides automated comparison and analysis of control flow graphs (CFGs) generated by multiple binary analysis tools. It standardizes basic block identifiers across different tools, performs comprehensive statistical analysis, and generates visualizations to compare the effectiveness and characteristics of each analysis tool.

## Supported Analysis Tools
The framework supports comparison of five major binary analysis tools:

### Required Tools
- **Radare2** - Open-source static analysis framework
- **Ghidra** - NSA's open-source software reverse engineering framework
- **Angr Fast** - Angr symbolic execution engine (fast analysis mode)

### Optional Tools (graceful degradation if unavailable)
- **Angr Emul** - Angr symbolic execution engine (emulation mode)
- **GCC** - GNU Compiler Collection CFG generation

The framework requires at least 2 tools to be successful for meaningful comparison. Optional tools may fail without terminating the analysis.

### Input Format Support
- **DOT format** (.dot) - Standard graph description language used by Radare2 and Angr
- **Ghidra GF format** (.gf) - Ghidra's native graph format
- Automatic format detection and parsing based on file extension and content structure


## Analysis Methodology

### Basic Block Name Standardization
The framework implements comprehensive basic block identifier normalization to enable meaningful comparison across tools:
- Removes tool-specific prefixes (`dbg.`, `sym.`, `imp.`, `fcn.`, `reloc.`, `unk.`)
- Normalizes address formats to lowercase hexadecimal
- Handles compiler-generated suffixes (`.part.N`, `.isra.N`, `.cold.N`)
- Preserves switch cases and labeled blocks that are important in CFG analysis
- Filters out invalid identifiers while preserving address-based blocks

### Graph Analysis and Metrics
The framework performs comprehensive graph-theoretic analysis using NetworkX:
- **Node Analysis**: Basic block count, unique block identification
- **Edge Analysis**: Control flow edge mapping and validation
- **Graph Density**: Measures connectivity (edges / possible_edges)
- **Degree Analysis**: In-degree and out-degree statistics for control flow
- **Connected Components**: Strongly connected component identification
- **Jaccard Similarity**: Pairwise tool comparison using intersection/union ratios

## Technical Implementation

### Core Libraries and Dependencies
- **NetworkX**: Graph creation, analysis, and algorithms
- **Matplotlib**: Visualization generation (charts, heatmaps)
- **Pandas**: Data manipulation and CSV export
- **Python Standard Library**: Regular expressions, file I/O

### Key Components
1. **CFGNormalizer**: Handles format parsing and basic block identifier standardization
2. **MultiCFGComparator**: Main analysis engine and comparison logic
3. **Logger**: Dual output system (console + file logging)

### Error Handling and Robustness
- **Graceful Degradation**: Continues analysis if one tool fails (except critical tools)
- **File Validation**: Checks for file existence, readability, and content validity
- **Format Detection**: Automatic handling of different graph formats
- **Memory Management**: Efficient handling of large basic block sets


## Installation

### Prerequisites
- Python 3.7 or higher
- pip (Python package installer)

### Quick Installation
1. Clone or download this repository
2. Install required Python packages:

```bash
pip install -r requirements.txt
```

### Verify Installation
Test that all dependencies are properly installed:

```bash
python verify_setup.py
```

## Usage

### Basic Usage
```bash
```bash
# Place your CFG files in the graph/ directory:
# Required files:
# - graph/r2.dot (Radare2 output)
# - graph/ghidra.gf (Ghidra export)
# - graph/angr_fast.dot (Angr fast mode)
# 
# Optional files (analysis continues if missing):
# - graph/angr_emul.dot (Angr emulation mode)
# - graph/gcc.dot (GCC generated output)

# Run the analysis
python3 run_analysis.py
```

## Output Generation

### Visualization Outputs
The framework generates multiple high-resolution PNG charts:
- **Basic Block Discovery Comparison**: Bar charts showing total basic block counts
- **Control Flow Comparison**: Analysis of control flow edge quantities across tools
- **Graph Density Comparison**: Visualization of graph connectivity metrics
- **Similarity Heatmap**: Color-coded Jaccard similarity matrix between all tool pairs

### Data Exports (CSV Format)
- **Statistics Summary**: Comprehensive metrics for each tool
- **Similarity Matrix**: Pairwise comparison coefficients
- **Basic Block Comparison**: Detailed block-by-block analysis
- **Control Flow Analysis**: Inter-block relationship mapping

### Logging and Reporting
- **Complete Analysis Log**: Detailed execution log with all intermediate results
- **Console Output**: Real-time progress and summary information
- **Error Reporting**: Comprehensive error handling with diagnostic information

## Generated Output Files

### Visualization Files (PNG)
- `result/basic_block_discovery_comparison.png` - Basic block discovery analysis across tools
- `result/control_flow_comparison.png` - Control flow comparison charts
- `result/graph_density_comparison.png` - Graph density and connectivity metrics
- `result/similarity_heatmap.png` - Jaccard similarity matrix heatmap

### Data Export Files (CSV)
- `result/multi_cfg_comparison_statistics.csv` - Comprehensive tool statistics
- `result/multi_cfg_comparison_similarity.csv` - Pairwise similarity matrix
- `result/multi_cfg_comparison_basic_blocks.csv` - Basic block-level comparison
- `result/multi_cfg_comparison_edges.csv` - Control flow edges analysis

### Log Files
- `analysis_log.txt` - Complete execution log with detailed analysis results
